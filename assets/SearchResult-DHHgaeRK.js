import{f as V,u as X,g as j,h as Z,y as ee,t as se,i as te,j as D,k as g,l as t,m as le,n as ae,s as Ee,R as L,p as Be,q as ue,v as ie,x as re,z as Ae,A as I,B as $,P as oe,C as ne,D as me,E as ce,F as he,G as ve,H as Ce,I as de,J as P,K as pe,L as _}from"./app-CN_M_RrQ.js";const Fe=["/Example.html","/Home.html","/","/assets_/WolframAlpha.html","/assets_/%E5%85%AC%E5%BC%8F%E7%BC%96%E8%BE%91%E5%99%A8.html","/assets_/%E8%8D%89%E7%A8%BF.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0-.html","/assets_/Callouts/Callouts-Abstract.html","/assets_/Callouts/Callouts-Bug.html","/assets_/Callouts/Callouts-ChatGPT.html","/assets_/Callouts/Callouts-Danger.html","/assets_/Callouts/Callouts-Example.html","/assets_/Callouts/Callouts-Failure.html","/assets_/Callouts/Callouts-Info.html","/assets_/Callouts/Callouts-Note.html","/assets_/Callouts/Callouts-Question.html","/assets_/Callouts/Callouts-Quote.html","/assets_/Callouts/Callouts-Success.html","/assets_/Callouts/Callouts-Tips.html","/assets_/Callouts/Callouts-Todo.html","/assets_/Callouts/Callouts-Warning.html","/assets_/Callouts/Callouts%E8%AF%AD%E6%B3%95.html","/assets_/Template/template-default.html","/assets_/Template/template-todo.html","/assets_/Template/template-%E5%A4%8D%E5%88%86%E6%9E%90.html","/assets_/Template/template-%E5%BE%AE%E7%A7%AF%E5%88%86.html","/assets_/Template/template-%E6%A6%82%E7%8E%87%E8%AE%BA.html","/assets_/Template/template-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0.html","/assets_/dataview%E6%9F%A5%E8%AF%A2/%E5%85%AC%E5%BC%8F.html","/assets_/dataview%E6%9F%A5%E8%AF%A2/%E6%9D%B1%E5%B7%A5%E9%81%8E%E5%8E%BB%E5%95%8F.html","/assets_/dataview%E6%9F%A5%E8%AF%A2/%E7%A9%BA%E5%B1%9E%E6%80%A7%E6%A3%80%E7%B4%A2.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/--%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0--.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E5%8F%A4%E5%85%B8%E8%BF%AD%E4%BB%A3%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E5%AF%B9%E7%A7%B0%E7%89%B9%E5%BE%81%E5%80%BC%E9%97%AE%E9%A2%98%E7%9A%84%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%8F%E5%BA%A6%E5%88%86%E6%9E%90%E4%B8%8E%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E9%97%AE%E9%A2%98.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%A2%AF%E5%BA%A6%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E7%9B%B4%E6%8E%A5%E8%A7%A3%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%89%B9%E5%BE%81%E5%80%BC%E9%97%AE%E9%A2%98%E7%9A%84%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/--%E8%A1%8C%E5%88%97%E5%BC%8F--.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/%E6%8B%89%E6%99%AE%E6%8B%89%E6%96%AF%E5%B1%95%E5%BC%80%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/%E8%A1%8C%E5%88%97%E5%BC%8F.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/%E8%A1%8C%E5%88%97%E5%BC%8F%E6%80%A7%E8%B4%A8.html","/404.html","/assets_/","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/","/assets_/Callouts/","/assets_/Template/","/assets_/dataview%E6%9F%A5%E8%AF%A2/","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/","/category/","/tag/","/tag/%E6%95%B0%E5%AD%A6/","/tag/%E5%B7%A5%E5%85%B7/","/tag/todo/","/tag/dataview/","/Blog/","/star/","/timeline/"],ye="SLIMSEARCH_QUERY_HISTORY",v=P(ye,[]),ge=()=>{const{queryHistoryCount:a}=_;return{enabled:a>0,queryHistories:v,addQueryHistory:u=>{v.value=Array.from(new Set([u,...v.value.slice(0,a-1)]))},removeQueryHistory:u=>{v.value=[...v.value.slice(0,u),...v.value.slice(u+1)]}}},Q=a=>Fe[a.id]+("anchor"in a?`#${a.anchor}`:""),_e="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:b}=_,C=P(_e,[]),fe=()=>({enabled:b>0,resultHistories:C,addResultHistory:B=>{{const u={link:Q(B),display:B.display};"header"in B&&(u.header=B.header),C.value=[u,...C.value.slice(0,b-1)]}},removeResultHistory:B=>{C.value=[...C.value.slice(0,B),...C.value.slice(B+1)]}}),He=a=>{const B=oe(),u=j(),f=ne(),i=D(0),d=g(()=>i.value>0),o=me([]);return ce(()=>{const{search:H,terminate:m}=he(),p=Ce(c=>{const{resultsFilter:w=l=>l,querySplitter:h,suggestionsFilter:T,...E}=B.value;c?(i.value+=1,H(c,u.value,E).then(l=>w(l,c,u.value,f.value)).then(l=>{i.value-=1,o.value=l}).catch(l=>{console.warn(l),i.value-=1,i.value||(o.value=[])})):o.value=[]},_.searchDelay-_.suggestDelay,{maxWait:5e3});ve([a,u],([c])=>p(c.join(" "))),de(()=>{m()})}),{isSearching:d,results:o}};var Re=V({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:B}){const u=X(),f=j(),i=Z(ee),{addQueryHistory:d,queryHistories:o,removeQueryHistory:H}=ge(),{resultHistories:m,addResultHistory:p,removeResultHistory:c}=fe(),w=se(a,"queries"),{results:h,isSearching:T}=He(w),E=te({isQuery:!0,index:0}),l=D(0),n=D(0),q=g(()=>o.value.length>0||m.value.length>0),R=g(()=>h.value.length>0),k=g(()=>h.value[l.value]||null),M=()=>{const{isQuery:e,index:s}=E;s===0?(E.isQuery=!e,E.index=e?m.value.length-1:o.value.length-1):E.index=s-1},U=()=>{const{isQuery:e,index:s}=E;s===(e?o.value.length-1:m.value.length-1)?(E.isQuery=!e,E.index=0):E.index=s+1},O=()=>{l.value=l.value>0?l.value-1:h.value.length-1,n.value=k.value.contents.length-1},W=()=>{l.value=l.value<h.value.length-1?l.value+1:0,n.value=0},Y=()=>{n.value<k.value.contents.length-1?n.value+=1:W()},G=()=>{n.value>0?n.value-=1:O()},x=e=>e.map(s=>pe(s)?s:t(s[0],s[1])),z=e=>{if(e.type==="customField"){const s=re[e.index]||"$content",[r,y=""]=Ae(s)?s[f.value].split("$content"):s.split("$content");return e.display.map(A=>t("div",x([r,...A,y])))}return e.display.map(s=>t("div",x(s)))},F=()=>{l.value=0,n.value=0,B("updateQuery",""),B("close")},J=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},i.value.queryHistory),o.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:E.isQuery&&E.index===s}],onClick:()=>{B("updateQuery",e)}},[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:$,onClick:r=>{r.preventDefault(),r.stopPropagation(),H(s)}})]))])),K=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},i.value.resultHistory),m.value.map((e,s)=>t(L,{to:e.link,class:["slimsearch-result-item",{active:!E.isQuery&&E.index===s}],onClick:()=>{F()}},()=>[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(r=>x(r)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:$,onClick:r=>{r.preventDefault(),r.stopPropagation(),c(s)}})]))]));return le("keydown",e=>{if(a.isFocusing){if(R.value){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const s=k.value.contents[n.value];d(a.queries.join(" ")),p(s),u.push(Q(s)),F()}}else if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")U();else if(e.key==="Enter"){const{index:s}=E;E.isQuery?(B("updateQuery",o.value[s]),e.preventDefault()):(u.push(m.value[s].link),F())}}}),ae([l,n],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!R.value:!q.value}],id:"slimsearch-results"},a.queries.length?T.value?t(Ee,{hint:i.value.searching}):R.value?t("ul",{class:"slimsearch-result-list"},h.value.map(({title:e,contents:s},r)=>{const y=l.value===r;return t("li",{class:["slimsearch-result-list-item",{active:y}]},[t("div",{class:"slimsearch-result-title"},e||i.value.defaultTitle),s.map((A,N)=>{const S=y&&n.value===N;return t(L,{to:Q(A),class:["slimsearch-result-item",{active:S,"aria-selected":S}],onClick:()=>{d(a.queries.join(" ")),p(A),F()}},()=>[A.type==="text"?null:t(A.type==="title"?Be:A.type==="heading"?ue:ie,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[A.type==="text"&&A.header?t("div",{class:"content-header"},A.header):null,t("div",z(A))])])})])})):i.value.emptyResult:q.value?[J(),K()]:i.value.emptyHistory)}});export{Re as default};
