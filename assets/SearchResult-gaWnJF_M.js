import{g as V,u as X,h as M,i as Z,j as ee,t as se,k as te,l as Q,m as g,n as t,p as le,w as ae,q as ue,R as L,v as ie,x as re,y as Ee,z as oe,A as ne,B as I,C as $,D as Be,E as ce,F as me,G as Ae,H as he,I as ve,J as de,K as Ce,L as j,M as pe,N as _}from"./app-CsRZrD7c.js";const ye=["/Example.html","/Home.html","/","/assets_/WolframAlpha.html","/assets_/%E5%85%AC%E5%BC%8F%E7%BC%96%E8%BE%91%E5%99%A8.html","/assets_/%E8%8D%89%E7%A8%BF.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0-.html","/assets_/Callouts/Callouts-Abstract.html","/assets_/Callouts/Callouts-Bug.html","/assets_/Callouts/Callouts-ChatGPT.html","/assets_/Callouts/Callouts-Danger.html","/assets_/Callouts/Callouts-Example.html","/assets_/Callouts/Callouts-Failure.html","/assets_/Callouts/Callouts-Info.html","/assets_/Callouts/Callouts-Note.html","/assets_/Callouts/Callouts-Question.html","/assets_/Callouts/Callouts-Quote.html","/assets_/Callouts/Callouts-Success.html","/assets_/Callouts/Callouts-Tips.html","/assets_/Callouts/Callouts-Todo.html","/assets_/Callouts/Callouts-Warning.html","/assets_/Callouts/Callouts%E8%AF%AD%E6%B3%95.html","/assets_/Template/template-default.html","/assets_/Template/template-todo.html","/assets_/Template/template-%E5%A4%8D%E5%88%86%E6%9E%90.html","/assets_/Template/template-%E5%BE%AE%E7%A7%AF%E5%88%86.html","/assets_/Template/template-%E6%A6%82%E7%8E%87%E8%AE%BA.html","/assets_/Template/template-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0.html","/assets_/dataview%E6%9F%A5%E8%AF%A2/%E5%85%AC%E5%BC%8F.html","/assets_/dataview%E6%9F%A5%E8%AF%A2/%E6%9D%B1%E5%B7%A5%E9%81%8E%E5%8E%BB%E5%95%8F.html","/assets_/dataview%E6%9F%A5%E8%AF%A2/%E7%A9%BA%E5%B1%9E%E6%80%A7%E6%A3%80%E7%B4%A2.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/--%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0--.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E7%9B%B4%E6%8E%A5%E8%A7%A3%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/--%E8%A1%8C%E5%88%97%E5%BC%8F--.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/%E6%8B%89%E6%99%AE%E6%8B%89%E6%96%AF%E5%B1%95%E5%BC%80%E6%B3%95.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/%E8%A1%8C%E5%88%97%E5%BC%8F.html","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/%E8%A1%8C%E5%88%97%E5%BC%8F%E6%80%A7%E8%B4%A8.html","/404.html","/assets_/","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/","/assets_/Callouts/","/assets_/Template/","/assets_/dataview%E6%9F%A5%E8%AF%A2/","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E6%95%B0%E5%80%BC%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/","/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/%E8%A1%8C%E5%88%97%E5%BC%8F/","/category/","/tag/","/tag/%E6%95%B0%E5%AD%A6/","/tag/%E5%B7%A5%E5%85%B7/","/tag/todo/","/tag/dataview/","/Blog/","/star/","/timeline/"],Fe="SLIMSEARCH_QUERY_HISTORY",v=j(Fe,[]),ge=()=>{const{queryHistoryCount:a}=_;return{enabled:a>0,queryHistories:v,addQueryHistory:r=>{v.value=Array.from(new Set([r,...v.value.slice(0,a-1)]))},removeQueryHistory:r=>{v.value=[...v.value.slice(0,r),...v.value.slice(r+1)]}}},T=a=>ye[a.id]+("anchor"in a?`#${a.anchor}`:""),_e="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:b}=_,d=j(_e,[]),fe=()=>({enabled:b>0,resultHistories:d,addResultHistory:i=>{{const r={link:T(i),display:i.display};"header"in i&&(r.header=i.header),d.value=[r,...d.value.slice(0,b-1)]}},removeResultHistory:i=>{d.value=[...d.value.slice(0,i),...d.value.slice(i+1)]}}),He=a=>{const i=Be(),r=M(),f=ce(),E=Q(0),C=g(()=>E.value>0),B=me([]);return Ae(()=>{const{search:H,terminate:m}=he(),p=de(A=>{const{resultsFilter:w=l=>l,querySplitter:h,suggestionsFilter:q,...u}=i.value;A?(E.value+=1,H(A,r.value,u).then(l=>w(l,A,r.value,f.value)).then(l=>{E.value-=1,B.value=l}).catch(l=>{console.warn(l),E.value-=1,E.value||(B.value=[])})):B.value=[]},_.searchDelay-_.suggestDelay,{maxWait:5e3});ve([a,r],([A])=>p(A.join(" "))),Ce(()=>{m()})}),{isSearching:C,results:B}};var Re=V({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:i}){const r=X(),f=M(),E=Z(ee),{addQueryHistory:C,queryHistories:B,removeQueryHistory:H}=ge(),{resultHistories:m,addResultHistory:p,removeResultHistory:A}=fe(),w=se(a,"queries"),{results:h,isSearching:q}=He(w),u=te({isQuery:!0,index:0}),l=Q(0),c=Q(0),D=g(()=>B.value.length>0||m.value.length>0),R=g(()=>h.value.length>0),k=g(()=>h.value[l.value]||null),P=()=>{const{isQuery:e,index:s}=u;s===0?(u.isQuery=!e,u.index=e?m.value.length-1:B.value.length-1):u.index=s-1},U=()=>{const{isQuery:e,index:s}=u;s===(e?B.value.length-1:m.value.length-1)?(u.isQuery=!e,u.index=0):u.index=s+1},O=()=>{l.value=l.value>0?l.value-1:h.value.length-1,c.value=k.value.contents.length-1},W=()=>{l.value=l.value<h.value.length-1?l.value+1:0,c.value=0},Y=()=>{c.value<k.value.contents.length-1?c.value+=1:W()},G=()=>{c.value>0?c.value-=1:O()},x=e=>e.map(s=>pe(s)?s:t(s[0],s[1])),N=e=>{if(e.type==="customField"){const s=oe[e.index]||"$content",[o,F=""]=ne(s)?s[f.value].split("$content"):s.split("$content");return e.display.map(n=>t("div",x([o,...n,F])))}return e.display.map(s=>t("div",x(s)))},y=()=>{l.value=0,c.value=0,i("updateQuery",""),i("close")},z=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},E.value.queryHistory),B.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:u.isQuery&&u.index===s}],onClick:()=>{i("updateQuery",e)}},[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:$,onClick:o=>{o.preventDefault(),o.stopPropagation(),H(s)}})]))])),J=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},E.value.resultHistory),m.value.map((e,s)=>t(L,{to:e.link,class:["slimsearch-result-item",{active:!u.isQuery&&u.index===s}],onClick:()=>{y()}},()=>[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>x(o)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:$,onClick:o=>{o.preventDefault(),o.stopPropagation(),A(s)}})]))]));return le("keydown",e=>{if(a.isFocusing){if(R.value){if(e.key==="ArrowUp")G();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const s=k.value.contents[c.value];C(a.queries.join(" ")),p(s),r.push(T(s)),y()}}else if(e.key==="ArrowUp")P();else if(e.key==="ArrowDown")U();else if(e.key==="Enter"){const{index:s}=u;u.isQuery?(i("updateQuery",B.value[s]),e.preventDefault()):(r.push(m.value[s].link),y())}}}),ae([l,c],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!R.value:!D.value}],id:"slimsearch-results"},a.queries.length?q.value?t(ue,{hint:E.value.searching}):R.value?t("ul",{class:"slimsearch-result-list"},h.value.map(({title:e,contents:s},o)=>{const F=l.value===o;return t("li",{class:["slimsearch-result-list-item",{active:F}]},[t("div",{class:"slimsearch-result-title"},e||E.value.defaultTitle),s.map((n,K)=>{const S=F&&c.value===K;return t(L,{to:T(n),class:["slimsearch-result-item",{active:S,"aria-selected":S}],onClick:()=>{C(a.queries.join(" ")),p(n),y()}},()=>[n.type==="text"?null:t(n.type==="title"?ie:n.type==="heading"?re:Ee,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",N(n))])])})])})):E.value.emptyResult:D.value?[z(),J()]:E.value.emptyHistory)}});export{Re as default};
